Q = [10 0  0  0  0  0  0  0  0  0  0  0;
     0   10 0  0  0  0  0  0  0  0  0  0;
     0   0  10  0  0  0  0  0  0  0  0  0;
     0   0  0  1  0  0  0  0  0  0  0  0;
     0   0  0  0  1  0  0  0  0  0  0  0;
     0   0  0  0  0  1  0  0  0  0  0  0;
     0   0  0  0  0  0  1  0  0  0  0  0;
     0   0  0  0  0  0  0  1  0  0  0  0;
     0   0  0  0  0  0  0  0  1  0  0  0;
     0   0  0  0  0  0  0  0  0  1  0  0;
     0   0  0  0  0  0  0  0  0  0  1  0;
     0   0  0  0  0  0  0  0  0  0  0  1];
R = eye(4);
[K_lqr, P, e] = lqr(A, B, Q, R);
% [K, P, e] = lqr(A, B, Q, R);

Qap = [ 10   0  0  0  0  0  0  0  0  0  0  0;
        0   10   0  0  0  0  0  0  0  0  0  0;
        0   0  1  0  0  0  0  0  0  0  0  0;
        0   0  0  100  0  0  0  0  0  0  0  0;
        0   0  0  0  100  0  0  0  0  0  0  0;
        0   0  0  0  0  1  0  0  0  0  0  0;
        0   0  0  0  0  0  1  0  0  0  0  0;
        0   0  0  0  0  0  0  1  0  0  0  0;
        0   0  0  0  0  0  0  0  1  0  0  0;
        0   0  0  0  0  0  0  0  0  1  0  0;
        0   0  0  0  0  0  0  0  0  0  1  0;
        0   0  0  0  0  0  0  0  0  0  0  1];
Qap = [ Qap                                 zeros(length(Qap), size(Bap,2));
        zeros(size(Bap,2), length(Qap))     1*eye(size(Bap,2))];
Rap = eye(4);
[K_explqr, Pg, e] = lqr(Aap, Bap, Qap, Rap);
